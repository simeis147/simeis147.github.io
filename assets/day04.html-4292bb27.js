import{_ as e}from"./plugin-vue_export-helper-c27b6911.js";import{r as o,o as c,c as i,e as s,f as n,d as p,b as a}from"./app-de21d070.js";const l="/assets/image-20210803081955246-6ceb2ac5.png",u="/assets/image-20210803084742416-81661b8d.png",r="/assets/image-20210803123858691-95d89b66.png",d="/assets/image-20210803124220869-e0d4c70f.png",k="/assets/image-20210803125619732-e8031ffb.png",m="/assets/image-20210803125942295-7733d48e.png",v="/assets/image-20210803130455590-e045e28e.png",g="/assets/image-20210803232054156-387bb87b.png",b="/assets/image-20210803232433983-56617a91.png",h="/assets/image-20210805160234154-c4b4f6ec.png",f="/assets/image-20210803224818828-710ebb81.png",y="/assets/image-20210803231134157-f14296a3.png",q="/assets/image-20210803231302464-f93d65fe.png",w="/assets/image-20210803234122966-e298b7d8.png",D="/assets/image-20210803235329340-74a23f20.png",x="/assets/image-20210803235459347-05a84065.png",j="/assets/image-20210803235749393-b6fabbcf.png",_="/assets/image-20210804003343531-9a55b81c.png",S="/assets/image-20210804003752632-6e88bcfc.png",F="/assets/image-20210804004529310-4a9b02da.png",I="/assets/image-20210804005030527-3634c2e1.png",A="/assets/image-20210804180408584-ef6ab53e.png",L="/assets/image-20210804174956706-2d0fcc02.png",z="/assets/image-20210804175034622-2c45dfba.png",P="/assets/image-20210804175658010-74b1c00d.png",C="/assets/image-20210804223703893-823223f0.png",E="/assets/image-20210804224842336-27dabfff.png",O="/assets/image-20210804225259854-c98f47a3.png",R="/assets/image-20210805100944028-15d1120a.png",W="/assets/image-20210804232447587-ee995da2.png",N="/assets/image-20210804233459252-e93c6be5.png",T="/assets/image-20210804234104633-5a13b330.png",U="data:image/png;base64,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",B="/assets/image-20210804234442923-727600b1.png",M="/assets/image-20210805101812209-137407ab.png",Q={},G=a('<h1 id="瑞吉外卖基础-day04" tabindex="-1"><a class="header-anchor" href="#瑞吉外卖基础-day04" aria-hidden="true">#</a> 瑞吉外卖基础-Day04</h1><h2 id="_1-文件上传下载" tabindex="-1"><a class="header-anchor" href="#_1-文件上传下载" aria-hidden="true">#</a> 1. 文件上传下载</h2><h3 id="_1-1-上传介绍" tabindex="-1"><a class="header-anchor" href="#_1-1-上传介绍" aria-hidden="true">#</a> 1.1 上传介绍</h3><h4 id="_1-1-1-概述" tabindex="-1"><a class="header-anchor" href="#_1-1-1-概述" aria-hidden="true">#</a> 1.1.1 概述</h4><p>文件上传，也称为upload，是指将本地图片、视频、音频等文件上传到服务器上，可以供其他用户浏览或下载的过程</p><figure><img src="'+l+`" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>文件上传时，对页面的form表单有如下要求：</p><table><thead><tr><th>表单属性</th><th>取值</th><th>说明</th></tr></thead><tbody><tr><td>method</td><td>post</td><td>必须选择post方式提交</td></tr><tr><td>enctype</td><td>multipart/form-data</td><td>采用multipart格式上传文件</td></tr><tr><td>type</td><td>file</td><td>使用input的file控件上传</td></tr></tbody></table><h4 id="_1-1-2-前端介绍" tabindex="-1"><a class="header-anchor" href="#_1-1-2-前端介绍" aria-hidden="true">#</a> 1.1.2 前端介绍</h4><ol><li><p><strong>简单html页面表单</strong></p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>post<span class="token punctuation">&quot;</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/common/upload<span class="token punctuation">&quot;</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>multipart/form-data<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myFile<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span>  <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>提交<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>ElementUI中提供的upload上传组件</strong></p><p>目前一些前端组件库也提供了相应的上传组件，但是底层原理还是基于form表单的文件上传</p><figure><img src="`+u+`" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure></li></ol><h4 id="_1-1-3-服务端介绍" tabindex="-1"><a class="header-anchor" href="#_1-1-3-服务端介绍" aria-hidden="true">#</a> 1.1.3 服务端介绍</h4><p>服务端要接收客户端页面上传的文件，通常都会使用Apache的两个组件：</p><ul><li>commons-fileupload</li><li>commons-io</li></ul><p>而Spring框架在spring-web包中对文件上传进行了封装，大大简化了服务端代码，只需要在Controller的方法中声明一个MultipartFile类型的参数即可接收上传的文件</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * 文件上传
 * <span class="token keyword">@param</span> <span class="token parameter">file</span>
 * <span class="token keyword">@return</span>
 */</span>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/upload&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-2-下载介绍" tabindex="-1"><a class="header-anchor" href="#_1-2-下载介绍" aria-hidden="true">#</a> 1.2 下载介绍</h3><p>文件下载，也称为download，是指将文件从服务器传输到本地计算机的过程<br> 通过浏览器进行文件下载，通常有两种表现形式</p><ol><li><p><strong>以附件形式下载，弹出保存对话框，将文件保存到指定磁盘目录</strong></p><figure><img src="`+r+'" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p><strong>直接在浏览器中打开</strong></p><p>今天所需要实现的菜品展示，表现形式为在浏览器中直接打开</p><figure><img src="'+d+'" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>通过浏览器进行文件下载，本质上就是服务端将文件以流的形式写回浏览器的过程</p></li></ol><h3 id="_1-3-上传代码实现" tabindex="-1"><a class="header-anchor" href="#_1-3-上传代码实现" aria-hidden="true">#</a> 1.3 上传代码实现</h3><h4 id="_1-3-1-前端代码" tabindex="-1"><a class="header-anchor" href="#_1-3-1-前端代码" aria-hidden="true">#</a> 1.3.1 前端代码</h4><p>使用资料中提供的上传页面，位置：资料/文件上传下载页面/upload.html，将其拷贝到项目的目录(resources/backend/page/demo)下，启动项目，访问上传页面</p>',21),K={href:"http://localhost:8080/backend/page/demo/upload.html",target:"_blank",rel:"noopener noreferrer"},Z=a('<figure><img src="'+k+'" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>在上述的浏览器抓取的网络请求中，上传文件的调用url，在哪里配置的呢，需要去看一下前端上传组件</p><figure><img src="'+m+'" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>虽然上述是ElementUI封装的代码，但是实际上最终还通过file域上传文件，如果未指定上传文件的参数名，默认为file</p><figure><img src="'+v+`" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_1-3-2-服务端实现" tabindex="-1"><a class="header-anchor" href="#_1-3-2-服务端实现" aria-hidden="true">#</a> 1.3.2 服务端实现</h4><ol><li><p><strong>application.yml</strong></p><p>需要在application.yml中定义文件存储路径</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">reggie</span><span class="token punctuation">:</span>
    <span class="token key atrule">path</span><span class="token punctuation">:</span> D<span class="token punctuation">:</span>\\img\\
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>CommonController</strong></p></li></ol><p>编写文件上传的方法，通过MultipartFile类型的参数即可接收上传的文件，方法形参的名称需要与页面的file域的name属性一致</p><p>所在包: com.itheima.reggie.controller</p><div class="hint-container tip"><p class="hint-container-title">上传逻辑</p><ol><li><p>获取文件的原始文件名，通过原始文件名获取文件后缀</p></li><li><p>通过UUID重新声明文件名，防止文件名称重复造成文件覆盖</p></li><li><p>创建文件存放目录</p></li><li><p>将上传的临时文件转存到指定位置</p></li></ol></div><p>代码实现:</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>reggie<span class="token punctuation">.</span>common<span class="token punctuation">.</span></span><span class="token class-name">R</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>multipart<span class="token punctuation">.</span></span><span class="token class-name">MultipartFile</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">UUID</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * 文件上传和下载
 */</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/common&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CommonController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;\${reggie.path}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> basePath<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * 文件上传
     * <span class="token keyword">@param</span> <span class="token parameter">file</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/upload&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//file是一个临时文件，需要转存到指定位置，否则本次请求完成后临时文件会删除</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//原始文件名</span>
        <span class="token class-name">String</span> originalFilename <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getOriginalFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//abc.jpg</span>
        <span class="token class-name">String</span> suffix <span class="token operator">=</span> originalFilename<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>originalFilename<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//使用UUID重新生成文件名，防止文件名称重复造成文件覆盖</span>
        <span class="token class-name">String</span> fileName <span class="token operator">=</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> suffix<span class="token punctuation">;</span><span class="token comment">//dfsdfdfd.jpg</span>

        <span class="token comment">//创建一个目录对象</span>
        <span class="token class-name">File</span> dir <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>basePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//判断当前目录是否存在</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>dir<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">//目录不存在，需要创建</span>
            dir<span class="token punctuation">.</span><span class="token function">mkdirs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">//将临时文件转存到指定位置</span>
            file<span class="token punctuation">.</span><span class="token function">transferTo</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>basePath <span class="token operator">+</span> fileName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>    
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_1-3-3-测试" tabindex="-1"><a class="header-anchor" href="#_1-3-3-测试" aria-hidden="true">#</a> 1.3.3 测试</h4>`,13),V={href:"http://localhost:8080/backend/page/demo/upload.html",target:"_blank",rel:"noopener noreferrer"},X=a('<figure><img src="'+g+'" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>这样的话，就要求在测试时，每一次都需要先登录，登录完成后在进行图片上传的测试，为了简化的测试，可以在 LoginCheckFilter 的doFilter方法中，在不需要处理的请求路径的数组中再加入请求路径 /common/**</p><figure><img src="'+b+'" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>在测试文件上传时，可以通过debug的形式来跟踪上传的整个过程，验证一下临时文件是否存在，以及上传完成之后，临时文件是否会自动删除</p><figure><img src="'+h+`" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_1-4-下载代码实现" tabindex="-1"><a class="header-anchor" href="#_1-4-下载代码实现" aria-hidden="true">#</a> 1.4 下载代码实现</h3><h4 id="_1-4-1-前端代码" tabindex="-1"><a class="header-anchor" href="#_1-4-1-前端代码" aria-hidden="true">#</a> 1.4.1 前端代码</h4><p>文件下载，前端页面可以使用&lt;img&gt;标签展示下载的图片</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>imageUrl<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>imageUrl<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>avatar<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>img</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>通过&lt;img&gt;标签如何展示图片数据呢</p><figure><img src="`+f+`" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>在文件上传成功后，在 handleAvatarSuccess 方法中获取文件上传成功之后返回的数据(文件名)，然后调用 /common/download?name=xxx 进行文件的下载<br> 想让上传的照片能够在页面展示出来，需要在服务端将文件以流的形式写回浏览器</p><h4 id="_1-4-2-服务端代码" tabindex="-1"><a class="header-anchor" href="#_1-4-2-服务端代码" aria-hidden="true">#</a> 1.4.2 服务端代码</h4><p>在 CommonController 中定义方法download，并接收页面传递的参数name，然后读取图片文件的数据，然后以流的形式写回浏览器</p><div class="hint-container tip"><p class="hint-container-title">具体逻辑</p><ol><li><p>定义输入流，通过输入流读取文件内容</p></li><li><p>通过response对象，获取到输出流</p></li><li><p>通过response对象设置响应数据格式(image/jpeg)</p></li><li><p>通过输入流读取文件数据，然后通过上述的输出流写回浏览器</p></li><li><p>关闭资源</p></li></ol></div><p>代码实现:</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * 文件下载
 * <span class="token keyword">@param</span> <span class="token parameter">name</span>
 * <span class="token keyword">@param</span> <span class="token parameter">response</span>
 */</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/download&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">download</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">//输入流，通过输入流读取文件内容</span>
        <span class="token class-name">FileInputStream</span> fileInputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>basePath <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//输出流，通过输出流将文件写回浏览器</span>
        <span class="token class-name">ServletOutputStream</span> outputStream <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">&quot;image/jpeg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>len <span class="token operator">=</span> fileInputStream<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            outputStream<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>bytes<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
            outputStream<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//关闭资源</span>
        outputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fileInputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_1-4-3-测试" tabindex="-1"><a class="header-anchor" href="#_1-4-3-测试" aria-hidden="true">#</a> 1.4.3 测试</h4>`,18),Y={href:"http://localhost:8080/backend/page/demo/upload.html",target:"_blank",rel:"noopener noreferrer"},H=a('<p><img src="'+y+'" alt=" " loading="lazy"> 通过F12查询页面发起的请求及响应的数据：</p><figure><img src="'+q+'" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="_2-菜品新增" tabindex="-1"><a class="header-anchor" href="#_2-菜品新增" aria-hidden="true">#</a> 2. 菜品新增</h2><h3 id="_2-1-需求分析" tabindex="-1"><a class="header-anchor" href="#_2-1-需求分析" aria-hidden="true">#</a> 2.1 需求分析</h3><p>后台系统中可以管理菜品信息，通过新增功能来添加一个新的菜品，在添加菜品时需要选择当前菜品所属的菜品分类，并且需要上传菜品图片，在移动端会按照菜品分类来展示对应的菜品信息</p><figure><img src="'+w+'" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_2-2-数据模型" tabindex="-1"><a class="header-anchor" href="#_2-2-数据模型" aria-hidden="true">#</a> 2.2 数据模型</h3><figure><img src="'+D+'" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>新增菜品，其实就是将新增页面录入的菜品信息插入到dish表，如果添加了口味做法，还需要向dish_flavor表插入数据。所以在新增菜品时，涉及到两个表：</p><table><thead><tr><th>表结构</th><th>说明</th></tr></thead><tbody><tr><td>dish</td><td>菜品表</td></tr><tr><td>dish_flavor</td><td>菜品口味表</td></tr></tbody></table><ol><li><p><strong>菜品表:dish</strong></p><figure><img src="'+x+'" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p><strong>菜品口味表:dish_flavor</strong></p><figure><img src="'+j+`" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure></li></ol><h3 id="_2-3-准备工作" tabindex="-1"><a class="header-anchor" href="#_2-3-准备工作" aria-hidden="true">#</a> 2.3 准备工作</h3><p>在开发业务功能前，先将需要用到的类和接口基本结构创建好</p><p>1.<strong>实体类 DishFlavor</strong></p><p>所属包: com.itheima.reggie.entity</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">FieldFill</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">TableField</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Serializable</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">LocalDateTime</span></span><span class="token punctuation">;</span>
<span class="token doc-comment comment">/**
菜品口味
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DishFlavor</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
    <span class="token comment">//菜品id</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> dishId<span class="token punctuation">;</span>

    <span class="token comment">//口味名称</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token comment">//口味数据list</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> value<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>fill <span class="token operator">=</span> <span class="token class-name">FieldFill</span><span class="token punctuation">.</span><span class="token constant">INSERT</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">LocalDateTime</span> createTime<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>fill <span class="token operator">=</span> <span class="token class-name">FieldFill</span><span class="token punctuation">.</span><span class="token constant">INSERT_UPDATE</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">LocalDateTime</span> updateTime<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>fill <span class="token operator">=</span> <span class="token class-name">FieldFill</span><span class="token punctuation">.</span><span class="token constant">INSERT</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> createUser<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>fill <span class="token operator">=</span> <span class="token class-name">FieldFill</span><span class="token punctuation">.</span><span class="token constant">INSERT_UPDATE</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> updateUser<span class="token punctuation">;</span>

    <span class="token comment">//是否删除</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> isDeleted<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2.<strong>Mapper接口DishFlavorMapper</strong></p><p>所属包: com.itheima.reggie.mapper</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span></span><span class="token class-name">BaseMapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>reggie<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">DishFlavor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Mapper</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DishFlavorMapper</span> <span class="token keyword">extends</span> <span class="token class-name">BaseMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DishFlavor</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3.<strong>业务层接口 DishFlavorService</strong></p><p>所属包: com.itheima.reggie.service</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>extension<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">IService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>reggie<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">DishFlavor</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DishFlavorService</span> <span class="token keyword">extends</span> <span class="token class-name">IService</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DishFlavor</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>4.<strong>业务层实现类 DishFlavorServiceImpl</strong></p><p>所属包: com.itheima.reggie.service.impl</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>extension<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">ServiceImpl</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>reggie<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">DishFlavor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>reggie<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span></span><span class="token class-name">DishFlavorMapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>reggie<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">DishFlavorService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DishFlavorServiceImpl</span> <span class="token keyword">extends</span> <span class="token class-name">ServiceImpl</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DishFlavorMapper</span><span class="token punctuation">,</span><span class="token class-name">DishFlavor</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">DishFlavorService</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>5.<strong>控制层 DishController</strong></p><p>菜品及菜品口味的相关操作，统一使用这一个controller即可</p><p>所属包： com.itheima.reggie.controller</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>reggie<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">DishFlavorService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>reggie<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">DishService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token doc-comment comment">/**
 * 菜品管理
 */</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/dish&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DishController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">DishService</span> dishService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">DishFlavorService</span> dishFlavorService<span class="token punctuation">;</span>
<span class="token punctuation">}</span>    
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-4-前端页面分析" tabindex="-1"><a class="header-anchor" href="#_2-4-前端页面分析" aria-hidden="true">#</a> 2.4 前端页面分析</h3><p>接下来实现新增菜品功能，在开发代码之前，需要梳理一下新增菜品时前端页面和服务端的交互过程</p><p>1.点击新建菜品按钮，访问页面(backend/page/food/add.html)，页面加载时发送ajax请求，请求服务端获取菜品分类数据并展示到下拉框中</p><figure><img src="`+_+'" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>2.页面发送请求进行图片上传，请求服务端将图片保存到服务器(上传功能已实现)</p><p>3.页面发送请求进行图片下载，将上传的图片进行回显(下载功能已实现)</p><figure><img src="'+S+'" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>4.点击保存按钮，发送ajax请求，将菜品相关数据以json形式提交到服务端</p><p>页面代码:</p><figure><img src="'+F+'" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>浏览器抓取请求:</p><figure><img src="'+I+`" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>开发新增菜品功能，其实就是在服务端编写代码去处理前端页面发送的这4次请求(上传、下载已实现)即可<br> 经过上述的分析，还需要在服务端实现两块功能</p><p>A. 菜品分类数据列表查询</p><table><thead><tr><th>请求</th><th>说明</th></tr></thead><tbody><tr><td>请求方式</td><td>GET</td></tr><tr><td>请求路径</td><td>/category/list</td></tr><tr><td>请求参数</td><td>?type=1</td></tr></tbody></table><p>B. 保存菜品信息</p><table><thead><tr><th>请求</th><th>说明</th></tr></thead><tbody><tr><td>请求方式</td><td>POST</td></tr><tr><td>请求路径</td><td>/dish</td></tr><tr><td>请求参数</td><td>json格式</td></tr></tbody></table><h3 id="_2-5-代码实现" tabindex="-1"><a class="header-anchor" href="#_2-5-代码实现" aria-hidden="true">#</a> 2.5 代码实现</h3><h4 id="_2-5-1-菜品分类查询" tabindex="-1"><a class="header-anchor" href="#_2-5-1-菜品分类查询" aria-hidden="true">#</a> 2.5.1 菜品分类查询</h4><p>在CategoryController中增加方法实现菜品分类查询，根据分类进行查询，并对查询的结果按照sort排序字段进行升序排序，如果sort相同，再按照修改时间倒序排序</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
* 根据条件查询分类数据
* <span class="token keyword">@param</span> <span class="token parameter">category</span>
* <span class="token keyword">@return</span>
*/</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/list&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Category</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">list</span><span class="token punctuation">(</span><span class="token class-name">Category</span> category<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//条件构造器</span>
    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Category</span><span class="token punctuation">&gt;</span></span> queryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//添加条件</span>
    queryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span>category<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">,</span><span class="token class-name">Category</span><span class="token operator">::</span><span class="token function">getType</span><span class="token punctuation">,</span>category<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//添加排序条件</span>
    queryWrapper<span class="token punctuation">.</span><span class="token function">orderByAsc</span><span class="token punctuation">(</span><span class="token class-name">Category</span><span class="token operator">::</span><span class="token function">getSort</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orderByDesc</span><span class="token punctuation">(</span><span class="token class-name">Category</span><span class="token operator">::</span><span class="token function">getUpdateTime</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Category</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> categoryService<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span>queryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>代码编写完毕之后，可以打开新增菜品页面，查看响应的数据，及页面下拉列表的渲染情况：</p><figure><img src="`+A+`" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_2-5-3-保存菜品信息" tabindex="-1"><a class="header-anchor" href="#_2-5-3-保存菜品信息" aria-hidden="true">#</a> 2.5.3 保存菜品信息</h4><p>在上述的分析中，可以看到在保存菜品时，页面传递过来的是json格式数据</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;佛跳墙&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span><span class="token number">88800</span><span class="token punctuation">,</span>
    <span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;image&quot;</span><span class="token operator">:</span><span class="token string">&quot;da9e1c70-fc32-4781-9510-a1c4ccd2ff59.jpg&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;description&quot;</span><span class="token operator">:</span><span class="token string">&quot;佛跳墙&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;categoryId&quot;</span><span class="token operator">:</span><span class="token string">&quot;1397844357980663809&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;flavors&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;辣度&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;[\\&quot;不辣\\&quot;,\\&quot;微辣\\&quot;,\\&quot;中辣\\&quot;,\\&quot;重辣\\&quot;]&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;showOption&quot;</span><span class="token operator">:</span><span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;忌口&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;[\\&quot;不要葱\\&quot;,\\&quot;不要蒜\\&quot;,\\&quot;不要香菜\\&quot;,\\&quot;不要辣\\&quot;]&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;showOption&quot;</span><span class="token operator">:</span><span class="token boolean">false</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在服务端应该如何来封装前端传递的数据呢，如果使用菜品类Dish来封装，只能封装菜品的基本属性，flavors属性是无法封装的</p><p>这个时候，需要自定义一个实体类，然后继承自Dish，并对Dish的属性进行拓展，增加 flavors 集合属性(内部封装DishFlavor)</p><p>1.<strong>导入 DishDto 实体类</strong></p><p>封装页面传递的请求参数</p><p>所属包: com.itheima.reggie.dto</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>reggie<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">Dish</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>reggie<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">DishFlavor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DishDto</span> <span class="token keyword">extends</span> <span class="token class-name">Dish</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DishFlavor</span><span class="token punctuation">&gt;</span></span> flavors <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> categoryName<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Integer</span> copies<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>拓展：在做项目时，经常会涉及到各种类型的实体模型 基本包含以下几种</p></blockquote><table><thead><tr><th>实体模型</th><th>描述</th></tr></thead><tbody><tr><td>DTO</td><td>Data Transfer Object(数据传输对象)，一般用于展示层与服务层之间的数据传输</td></tr><tr><td>Entity</td><td>最常用实体类，基本和数据表一一对应，一个实体类对应一张表</td></tr><tr><td>VO</td><td>Value Object(值对象)，主要用于封装前端页面展示的数据对象，用一个VO对象来封装整个页面展示所需要的对象数据</td></tr><tr><td>PO</td><td>Persistant Object(持久层对象)，是ORM(Objevt Relational Mapping)框架中Entity，PO属性和数据库中表的字段形成一一对应关系</td></tr></tbody></table><p>2.<strong>DishController定义方法新增菜品</strong></p><p>在该Controller的方法中，不仅需要保存菜品的基本信息，还需要保存菜品的口味信息，需要操作两张表，所以需要在DishService接口中定义接口方法，在这个方法中需要保存上述的两部分数据</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * 新增菜品
 * <span class="token keyword">@param</span> <span class="token parameter">dishDto</span>
 * <span class="token keyword">@return</span>
 */</span>
<span class="token annotation punctuation">@PostMapping</span>
<span class="token keyword">public</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">DishDto</span> dishDto<span class="token punctuation">)</span><span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>dishDto<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    dishService<span class="token punctuation">.</span><span class="token function">saveWithFlavor</span><span class="token punctuation">(</span>dishDto<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">&quot;新增菜品成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3.<strong>DishService中增加方法saveWithFlavor</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//新增菜品，同时插入菜品对应的口味数据，需要操作两张表：dish、dish_flavor</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveWithFlavor</span><span class="token punctuation">(</span><span class="token class-name">DishDto</span> dishDto<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>4.<strong>DishServiceImpl中实现方法saveWithFlavor</strong></p><p>页面传递的菜品口味信息，仅仅包含name 和 value属性，缺少一个非常重要的属性dishId， 所以在保存完菜品的基本信息后，需要获取到菜品ID，然后为菜品口味对象属性dishId赋值</p><div class="hint-container tip"><p class="hint-container-title">具体逻辑</p><ol><li><p>保存菜品基本信息</p></li><li><p>获取保存的菜品ID</p></li><li><p>获取菜品口味列表，遍历列表，为菜品口味对象属性dishId赋值</p></li><li><p>批量保存菜品口味列表</p></li></ol></div><p>代码实现:</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">DishFlavorService</span> dishFlavorService<span class="token punctuation">;</span>
<span class="token doc-comment comment">/**
* 新增菜品，同时保存对应的口味数据
* <span class="token keyword">@param</span> <span class="token parameter">dishDto</span>
*/</span>
<span class="token annotation punctuation">@Transactional</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveWithFlavor</span><span class="token punctuation">(</span><span class="token class-name">DishDto</span> dishDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//保存菜品的基本信息到菜品表dish</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>dishDto<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">Long</span> dishId <span class="token operator">=</span> dishDto<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//菜品id</span>
    <span class="token comment">//菜品口味</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DishFlavor</span><span class="token punctuation">&gt;</span></span> flavors <span class="token operator">=</span> dishDto<span class="token punctuation">.</span><span class="token function">getFlavors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    flavors <span class="token operator">=</span> flavors<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        item<span class="token punctuation">.</span><span class="token function">setDishId</span><span class="token punctuation">(</span>dishId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> item<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//保存菜品口味数据到菜品口味表dish_flavor</span>
    dishFlavorService<span class="token punctuation">.</span><span class="token function">saveBatch</span><span class="token punctuation">(</span>flavors<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>说明:</p><p>​由于在 saveWithFlavor 方法中，进行了两次数据库的保存操作，操作了两张表，那么为了保证数据的一致性，需要在方法上加上注解 @Transactional来控制事务</p></blockquote><p>5.<strong>在引导类上加注解 @EnableTransactionManagement</strong></p><p>Service层方法上加的注解@Transactional要想生效，需要在引导类上加上注解 @EnableTransactionManagement， 开启对事务的支持</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@ServletComponentScan</span>
<span class="token annotation punctuation">@EnableTransactionManagement</span> <span class="token comment">//开启对事物管理的支持</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReggieApplication</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">ReggieApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;项目启动成功...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-6-功能测试" tabindex="-1"><a class="header-anchor" href="#_2-6-功能测试" aria-hidden="true">#</a> 2.6 功能测试</h3><p>进行菜品的新增测试，在测试时，可以通过debug断点跟踪的形式，查看传输的数据，及数据的封装</p><figure><img src="`+L+'" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>debug跟踪数据的封装情况:</p><figure><img src="'+z+'" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>测试完毕后，可以检查一下数据库中的数据保存情况</p><figure><img src="'+P+'" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="_3-菜品分页查询" tabindex="-1"><a class="header-anchor" href="#_3-菜品分页查询" aria-hidden="true">#</a> 3. 菜品分页查询</h2><h3 id="_3-1-需求分析" tabindex="-1"><a class="header-anchor" href="#_3-1-需求分析" aria-hidden="true">#</a> 3.1 需求分析</h3><figure><img src="'+C+'" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>在菜品列表展示时，除了菜品的基本信息(名称、售价、售卖状态、更新时间)外，还有两个字段略微特殊</p><p>第一个是图片字段，从数据库查询出来的仅仅是图片的名字，图片要想在表格中回显展示出来，就需要下载这个图片<br> 第二个是菜品分类，这里展示的是分类名称，而不是分类ID，此时就需要根据菜品的分类ID，去分类表中查询分类信息，然后在页面展示</p><h3 id="_3-2-前端页面分析" tabindex="-1"><a class="header-anchor" href="#_3-2-前端页面分析" aria-hidden="true">#</a> 3.2 前端页面分析</h3><p>在开发代码之前，需要梳理一下菜品分页查询时前端页面和服务端的交互过程</p><ol><li>访问页面(backend/page/food/list.html)时，发送ajax请求，将分页查询参数(page、pageSize、name)提交到服务端，获取分页数据</li><li>页面发送请求，请求服务端进行图片下载，用于页面图片展示</li></ol><figure><img src="'+E+'" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="'+O+`" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>开发菜品信息分页查询功能，其实就是在服务端编写代码去处理前端页面发送的这2次请求即可，而前端发起的请求中，图片文件下载回显的代码，已经实现了<br> 所以，只需要开发分页查询的功能即可</p><table><thead><tr><th>请求</th><th>说明</th></tr></thead><tbody><tr><td>请求方式</td><td>GET</td></tr><tr><td>请求路径</td><td>/dish/page</td></tr><tr><td>请求参数</td><td>?page=1&amp;pageSize=10&amp;name=xxx</td></tr></tbody></table><h3 id="_3-3-代码实现" tabindex="-1"><a class="header-anchor" href="#_3-3-代码实现" aria-hidden="true">#</a> 3.3 代码实现</h3><h4 id="_3-3-1-分析" tabindex="-1"><a class="header-anchor" href="#_3-3-1-分析" aria-hidden="true">#</a> 3.3.1 分析</h4><p>在 DishController 中开发方法，来完成菜品的条件分页查询，在分页查询时还需要给页面返回分类的名称，而分类的名称前端在接收的时候是通过 categoryName 属性获取的，那么对应的服务端也应该封装到 categoryName 属性中</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span> <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>categoryName<span class="token punctuation">&quot;</span></span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>菜品分类<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>而在的实体类 Dish 中，仅仅包含 categoryId， 不包含 categoryName，那么应该如何封装查询的数据呢？ 其实，这里可以返回DishDto对象，在该对象中可以拓展一个属性 categoryName，来封装菜品分类名称</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DishDto</span> <span class="token keyword">extends</span> <span class="token class-name">Dish</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DishFlavor</span><span class="token punctuation">&gt;</span></span> flavors <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> categoryName<span class="token punctuation">;</span> <span class="token comment">//菜品分类名称</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> copies<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">具体逻辑</p><ol><li><p>构造分页条件对象</p></li><li><p>构建查询及排序条件</p></li><li><p>执行分页条件查询</p></li><li><p>遍历分页查询列表数据，根据分类ID查询分类信息，从而获取该菜品的分类名称</p></li><li><p>封装数据并返回</p></li></ol></div><h4 id="_3-3-2-实现" tabindex="-1"><a class="header-anchor" href="#_3-3-2-实现" aria-hidden="true">#</a> 3.3.2 实现</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * 菜品信息分页查询
 * <span class="token keyword">@param</span> <span class="token parameter">page</span>
 * <span class="token keyword">@param</span> <span class="token parameter">pageSize</span>
 * <span class="token keyword">@param</span> <span class="token parameter">name</span>
 * <span class="token keyword">@return</span>
 */</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/page&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Page</span><span class="token punctuation">&gt;</span></span> <span class="token function">page</span><span class="token punctuation">(</span><span class="token keyword">int</span> page<span class="token punctuation">,</span><span class="token keyword">int</span> pageSize<span class="token punctuation">,</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//构造分页构造器对象</span>
    <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dish</span><span class="token punctuation">&gt;</span></span> pageInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>page<span class="token punctuation">,</span>pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DishDto</span><span class="token punctuation">&gt;</span></span> dishDtoPage <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//条件构造器</span>
    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dish</span><span class="token punctuation">&gt;</span></span> queryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//添加过滤条件</span>
    queryWrapper<span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span>name <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">,</span><span class="token class-name">Dish</span><span class="token operator">::</span><span class="token function">getName</span><span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//添加排序条件</span>
    queryWrapper<span class="token punctuation">.</span><span class="token function">orderByDesc</span><span class="token punctuation">(</span><span class="token class-name">Dish</span><span class="token operator">::</span><span class="token function">getUpdateTime</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//执行分页查询</span>
    dishService<span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span>pageInfo<span class="token punctuation">,</span>queryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//对象拷贝</span>
    <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>pageInfo<span class="token punctuation">,</span>dishDtoPage<span class="token punctuation">,</span><span class="token string">&quot;records&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dish</span><span class="token punctuation">&gt;</span></span> records <span class="token operator">=</span> pageInfo<span class="token punctuation">.</span><span class="token function">getRecords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DishDto</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> records<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        
        <span class="token class-name">DishDto</span> dishDto <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DishDto</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span>dishDto<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Long</span> categoryId <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">getCategoryId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//分类id</span>
        <span class="token comment">//根据id查询分类对象</span>
        <span class="token class-name">Category</span> category <span class="token operator">=</span> categoryService<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>categoryId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token keyword">if</span><span class="token punctuation">(</span>category <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token class-name">String</span> categoryName <span class="token operator">=</span> category<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            dishDto<span class="token punctuation">.</span><span class="token function">setCategoryName</span><span class="token punctuation">(</span>categoryName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> dishDto<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    dishDtoPage<span class="token punctuation">.</span><span class="token function">setRecords</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>dishDtoPage<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>数据库查询菜品信息时，获取到的分页查询结果 Page 的泛型为 Dish，而最终需要给前端页面返回的类型为 DishDto，所以这个时候就要进行转换，基本属性可以直接通过属性拷贝的形式对Page中的属性进行复制，而对于结果列表 records属性，是需要进行特殊处理的(需要封装菜品分类名称)</p></blockquote><h3 id="_3-4-功能测试" tabindex="-1"><a class="header-anchor" href="#_3-4-功能测试" aria-hidden="true">#</a> 3.4 功能测试</h3><p>代码编写完毕之后，重新启动服务，访问项目，可以通过debug端点的形式跟踪，整个分页查询过程中，数据的转换和封装</p><p>在测试的过程中，发现有一些菜品图片并没有展示出来</p><figure><img src="`+R+'" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>这是因为在导入sql脚本时，导入了一部分菜品的数据，而菜品的图片在的磁盘目录中并不存在，所以才会出现图片展示不出来的情况，而后续自己添加的菜品信息是没有问题的</p><h2 id="_4-菜品修改" tabindex="-1"><a class="header-anchor" href="#_4-菜品修改" aria-hidden="true">#</a> 4. 菜品修改</h2><h3 id="_4-1-需求分析" tabindex="-1"><a class="header-anchor" href="#_4-1-需求分析" aria-hidden="true">#</a> 4.1 需求分析</h3><p>在菜品管理列表页面点击修改按钮，跳转到修改菜品页面，在修改页面回显菜品相关信息并进行修改，最后点击确定按钮完成修改操作</p><figure><img src="'+W+'" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_4-2-前端页面分析" tabindex="-1"><a class="header-anchor" href="#_4-2-前端页面分析" aria-hidden="true">#</a> 4.2 前端页面分析</h3><p>在开发代码之前，需要梳理一下修改菜品时前端页面（add.html）和服务端的交互过程</p><ol><li><p>点击菜品列表的中的修改按钮，携带菜品id跳转至add.html</p><figure><img src="'+N+'" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>进入add.html，页面发送ajax请求，请求服务端获取分类数据，用于菜品分类下拉框中数据展示(<strong>已实现</strong>)</p></li><li><p>add.html获取id，发送ajax请求，请求服务端，根据id查询当前菜品信息，用于菜品信息回显</p><figure><img src="'+T+'" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>页面发送请求，请求服务端进行图片下载，用于页图片回显(<strong>已实现</strong>)</p><figure><img src="'+U+'" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>点击保存按钮，页面发送ajax请求，将修改后的菜品相关数据以json形式提交到服务端</p></li></ol><figure><img src="'+B+`" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>经过上述的分析，发现，菜品分类下拉框的展示、图片的下载回显功能都已经实现了，只需要在这里实现两个功能即可，分别是：</p><p>1.<strong>根据ID查询菜品及菜品口味信息</strong></p><table id=""><thead><tr><th>请求</th><th>说明</th></tr></thead><tbody><tr><td>请求方式</td><td>GET</td></tr><tr><td>请求路径</td><td>/dish/</td></tr></tbody></table><p>2.<strong>修改菜品及菜品口味信息</strong></p><table><thead><tr><th>请求</th><th>说明</th></tr></thead><tbody><tr><td>请求方式</td><td>PUT</td></tr><tr><td>请求路径</td><td>/dish</td></tr><tr><td>请求参数</td><td>json格式数据</td></tr></tbody></table><p>具体的json格式数据，可以通过浏览器抓取</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;1422783914845487106&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;佛跳墙&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;categoryId&quot;</span><span class="token operator">:</span><span class="token string">&quot;1397844357980663809&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span><span class="token number">88800</span><span class="token punctuation">,</span>
    <span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;image&quot;</span><span class="token operator">:</span><span class="token string">&quot;da9e1c70-fc32-4781-9510-a1c4ccd2ff59.jpg&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;description&quot;</span><span class="token operator">:</span><span class="token string">&quot;佛跳墙&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;status&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;sort&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;createTime&quot;</span><span class="token operator">:</span><span class="token string">&quot;2021-08-04 12:58:14&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;createUser&quot;</span><span class="token operator">:</span><span class="token string">&quot;1412578435737350122&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;updateUser&quot;</span><span class="token operator">:</span><span class="token string">&quot;1412578435737350122&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;flavors&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;1422783914883235842&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;dishId&quot;</span><span class="token operator">:</span><span class="token string">&quot;1422783914845487106&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;辣度&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;[\\&quot;不辣\\&quot;,\\&quot;微辣\\&quot;,\\&quot;中辣\\&quot;,\\&quot;重辣\\&quot;]&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;createTime&quot;</span><span class="token operator">:</span><span class="token string">&quot;2021-08-04 12:58:14&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;updateTime&quot;</span><span class="token operator">:</span><span class="token string">&quot;2021-08-04 12:58:14&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;createUser&quot;</span><span class="token operator">:</span><span class="token string">&quot;1412578435737350122&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;updateUser&quot;</span><span class="token operator">:</span><span class="token string">&quot;1412578435737350122&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;isDeleted&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;showOption&quot;</span><span class="token operator">:</span><span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;1422783914895818754&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;dishId&quot;</span><span class="token operator">:</span><span class="token string">&quot;1422783914845487106&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;忌口&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;[\\&quot;不要葱\\&quot;,\\&quot;不要蒜\\&quot;,\\&quot;不要香菜\\&quot;,\\&quot;不要辣\\&quot;]&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;createTime&quot;</span><span class="token operator">:</span><span class="token string">&quot;2021-08-04 12:58:14&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;updateTime&quot;</span><span class="token operator">:</span><span class="token string">&quot;2021-08-04 12:58:14&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;createUser&quot;</span><span class="token operator">:</span><span class="token string">&quot;1412578435737350122&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;updateUser&quot;</span><span class="token operator">:</span><span class="token string">&quot;1412578435737350122&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;isDeleted&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;showOption&quot;</span><span class="token operator">:</span><span class="token boolean">false</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-3-功能实现" tabindex="-1"><a class="header-anchor" href="#_4-3-功能实现" aria-hidden="true">#</a> 4.3 功能实现</h3><h4 id="_4-3-1-根据id查询菜品信息" tabindex="-1"><a class="header-anchor" href="#_4-3-1-根据id查询菜品信息" aria-hidden="true">#</a> 4.3.1 根据ID查询菜品信息</h4><h5 id="_4-3-1-1-代码实现" tabindex="-1"><a class="header-anchor" href="#_4-3-1-1-代码实现" aria-hidden="true">#</a> 4.3.1.1 代码实现</h5><p>页面发送ajax请求，请求服务端，根据id查询当前菜品信息和对应的口味信息，用于修改页面中菜品信息回显</p><p>1.在DishService接口中扩展getByIdWithFlavor方法</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//根据id查询菜品信息和对应的口味信息</span>
<span class="token keyword">public</span> <span class="token class-name">DishDto</span> <span class="token function">getByIdWithFlavor</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>2.在DishService实现类中实现此方法</p><div class="hint-container tip"><p class="hint-container-title">具体逻辑</p><ol><li><p>根据ID查询菜品的基本信息</p></li><li><p>根据菜品的ID查询菜品口味列表数据</p></li><li><p>组装数据并返回</p></li></ol></div><p>代码实现:</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
* 根据id查询菜品信息和对应的口味信息
* <span class="token keyword">@param</span> <span class="token parameter">id</span>
* <span class="token keyword">@return</span>
*/</span>
<span class="token keyword">public</span> <span class="token class-name">DishDto</span> <span class="token function">getByIdWithFlavor</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//查询菜品基本信息，从dish表查询</span>
    <span class="token class-name">Dish</span> dish <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">DishDto</span> dishDto <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DishDto</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>dish<span class="token punctuation">,</span>dishDto<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//查询当前菜品对应的口味信息，从dish_flavor表查询</span>
    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DishFlavor</span><span class="token punctuation">&gt;</span></span> queryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    queryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">DishFlavor</span><span class="token operator">::</span><span class="token function">getDishId</span><span class="token punctuation">,</span>dish<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DishFlavor</span><span class="token punctuation">&gt;</span></span> flavors <span class="token operator">=</span> dishFlavorService<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span>queryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    dishDto<span class="token punctuation">.</span><span class="token function">setFlavors</span><span class="token punctuation">(</span>flavors<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> dishDto<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3.在DishController中创建get方法</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
* 根据id查询菜品信息和对应的口味信息
* <span class="token keyword">@param</span> <span class="token parameter">id</span>
* <span class="token keyword">@return</span>
*/</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/{id}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DishDto</span><span class="token punctuation">&gt;</span></span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">DishDto</span> dishDto <span class="token operator">=</span> dishService<span class="token punctuation">.</span><span class="token function">getByIdWithFlavor</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>dishDto<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>@PathVariable : 该注解可以用来提取url路径中传递的请求参数</p></blockquote><h5 id="_4-3-1-2-功能测试" tabindex="-1"><a class="header-anchor" href="#_4-3-1-2-功能测试" aria-hidden="true">#</a> 4.3.1.2 功能测试</h5><p>编写完代码后，重启服务进行测试，点击列表的修改按钮，查询数据回显情况</p><figure><img src="`+M+`" alt=" " tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_4-3-2-修改菜品信息" tabindex="-1"><a class="header-anchor" href="#_4-3-2-修改菜品信息" aria-hidden="true">#</a> 4.3.2 修改菜品信息</h4><h5 id="_4-3-2-1-代码实现" tabindex="-1"><a class="header-anchor" href="#_4-3-2-1-代码实现" aria-hidden="true">#</a> 4.3.2.1 代码实现</h5><p>点击保存按钮，页面发送ajax请求，将修改后的菜品相关数据以json形式提交到服务端<br> 在修改菜品信息时需要注意，除了要更新dish菜品表，还需要更新dish_flavor菜品口味表</p><p>1.在DishService接口中扩展方法updateWithFlavor</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//更新菜品信息，同时更新对应的口味信息</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateWithFlavor</span><span class="token punctuation">(</span><span class="token class-name">DishDto</span> dishDto<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>2.在DishServiceImpl中实现方法updateWithFlavor</p><p>在该方法中，既需要更新dish菜品基本信息表，还需要更新dish_flavor菜品口味表<br> 而页面再操作时，关于菜品的口味，有修改，有新增，也有可能删除，应该如何更新菜品口味信息呢，其实，无论菜品口味信息如何变化，只需要保持一个原则：先删除，后添加</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token annotation punctuation">@Transactional</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateWithFlavor</span><span class="token punctuation">(</span><span class="token class-name">DishDto</span> dishDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//更新dish表基本信息</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateById</span><span class="token punctuation">(</span>dishDto<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//清理当前菜品对应口味数据---dish_flavor表的delete操作</span>
    <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DishFlavor</span><span class="token punctuation">&gt;</span></span> queryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    queryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">DishFlavor</span><span class="token operator">::</span><span class="token function">getDishId</span><span class="token punctuation">,</span>dishDto<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    dishFlavorService<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>queryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//添加当前提交过来的口味数据---dish_flavor表的insert操作</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DishFlavor</span><span class="token punctuation">&gt;</span></span> flavors <span class="token operator">=</span> dishDto<span class="token punctuation">.</span><span class="token function">getFlavors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    flavors <span class="token operator">=</span> flavors<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        item<span class="token punctuation">.</span><span class="token function">setDishId</span><span class="token punctuation">(</span>dishDto<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> item<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    dishFlavorService<span class="token punctuation">.</span><span class="token function">saveBatch</span><span class="token punctuation">(</span>flavors<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3.在DishController中创建update方法</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
* 修改菜品
* <span class="token keyword">@param</span> <span class="token parameter">dishDto</span>
* <span class="token keyword">@return</span>
*/</span>
<span class="token annotation punctuation">@PutMapping</span>
<span class="token keyword">public</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">DishDto</span> dishDto<span class="token punctuation">)</span><span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>dishDto<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    dishService<span class="token punctuation">.</span><span class="token function">updateWithFlavor</span><span class="token punctuation">(</span>dishDto<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">&quot;修改菜品成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_4-3-2-2-功能测试" tabindex="-1"><a class="header-anchor" href="#_4-3-2-2-功能测试" aria-hidden="true">#</a> 4.3.2.2 功能测试</h5><p>代码编写完成之后，重启服务，然后按照前面分析的操作流程进行测试，查看数据是否正常修改即可</p>`,154);function J($,nn){const t=o("ExternalLinkIcon");return c(),i("div",null,[G,s("p",null,[s("a",K,[n("http://localhost:8080/backend/page/demo/upload.html"),p(t)])]),Z,s("p",null,[n("访问上传页面 "),s("a",V,[n("http://localhost:8080/backend/page/demo/upload.html"),p(t)]),n("，然后点击上传图片，选择图片上传时，会发现图片并不能正常的上传，而且在浏览器中可以抓取到响应的数据，从图中可以判断出需要登录才可以操作")]),X,s("p",null,[n("访问页面 "),s("a",Y,[n("http://localhost:8080/backend/page/demo/upload.html"),p(t)]),n(" ，点击上传图片 ，选择图片进行上传，上传完毕之后，查看图片是否可以展示出来")]),H])}const tn=e(Q,[["render",J],["__file","day04.html.vue"]]);export{tn as default};
